entry: complex-workflow

complex-workflow:
  name: 'Workflow with Multiple Decisions'
  lambda_dir: lambdas/business

  tree:
    validate-user: age-decision
    age-decision: $age-conditions
    process-adult: premium-decision
    process-minor: notify-guardian
    premium-decision: $premium-conditions
    upgrade-premium: null
    keep-basic: null
    notify-guardian: null
  
  states:
    validate-user:
      name: validate_user
      type: lambda
    
    age-decision:
      name: check_age
      type: choice
    
    process-adult:
      name: process_adult
      type: lambda
    
    process-minor:
      name: process_minor
      type: lambda
      
    premium-decision:
      name: check_premium
      type: choice
      
    upgrade-premium:
      name: upgrade_premium
      type: lambda
      
    keep-basic:
      name: keep_basic
      type: lambda
      
    notify-guardian:
      name: notify_guardian
      type: lambda
  
  vars:
    $age-conditions:
      - "when $.user.age gte 18 then #process-adult else #process-minor"
      
    $premium-conditions:
      - "when ($.user.points gt 1000) and ($.user.active eq true) then #upgrade-premium"
      - "when $.user.points lt 1000 then when $.user.age lt 18 then #process-minor"
      - "#keep-basic"